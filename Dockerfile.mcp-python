ARG BASE_TAG=latest
FROM ghcr.io/obot-platform/mcp-images-phat-python:${BASE_TAG}

ARG MCP_PACKAGE
ARG MCP_VERSION
ARG MCP_COMMAND

USER root

# Install the MCP package using uvx
RUN uv tool install "${MCP_PACKAGE}@${MCP_VERSION}"

RUN cat > /usr/local/bin/entrypoint.sh << 'EOF' && chmod +x /usr/local/bin/entrypoint.sh
#!/bin/bash
${MCP_COMMAND}
EOF

USER 1000

ENTRYPOINT ["/usr/local/bin/entrypoint.sh"]
CMD ["--help"]